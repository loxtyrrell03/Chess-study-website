:root{
  --bg:#ffffff; --fg:#0f172a; --muted:#475569;
  --border:#94a3b8; --borderW:2px;
  --panel:#ffffff; --panel-muted:#f8fafc;
  --accent:#0ea5e9; --accent-600:#0284c7; --accent-100:#e0f2fe;

  /* Design system tokens */
  --radius-sm:8px; --radius-md:12px; --radius-lg:14px; --radius-xl:18px;
  --space-1:4px; --space-2:6px; --space-3:8px; --space-4:12px; --space-5:16px; --space-6:20px; --space-8:28px;
  --shadow-1:0 3px 10px rgba(15,23,42,.04);
  --shadow-2:0 8px 24px rgba(15,23,42,.06);
  --shadow-3:0 12px 36px rgba(15,23,42,.10);
  --ease: cubic-bezier(.22,.61,.36,1);
  --fast:140ms; --normal:220ms;
}
*{box-sizing:border-box}
html,body{background:var(--bg);color:var(--fg)}
*{-webkit-tap-highlight-color:transparent}

/* ===== Topbar / brand ===== */
.topbar{
  position:sticky; top:0; z-index:70;
  display:flex; align-items:center; justify-content:space-between; gap:14px;
  padding:10px 20px;
  background: linear-gradient(90deg, color-mix(in srgb,var(--accent-100) 75%, transparent), #fff);
  border-bottom: var(--borderW) solid var(--border);
  box-shadow: var(--shadow-2);
}
.brand{display:flex; align-items:center; gap:.55rem; min-width:0}
.brand .logo{font-size:1.35rem}
.brand-text{display:flex; flex-direction:column}
.brand-title{font-weight:800; letter-spacing:.2px}
.brand-sub{font-size:.72rem; color:var(--muted); margin-top:-2px}
.topnav-links{flex:1 1 auto; justify-content:center}
.topbar-actions{display:flex; align-items:center; gap:.5rem}
@media (max-width:900px){
  .brand-sub{display:none}
  .topnav-links{order:3; width:100%; justify-content:flex-start; overflow:auto}
}

/* ===== Common UI ===== */
.muted{color:var(--muted)}
.card{
  background:var(--panel);
  border:var(--borderW) solid var(--border);
  border-radius:var(--radius-lg);
  box-shadow:var(--shadow-1);
  overflow:hidden;
  transition:box-shadow var(--normal) var(--ease), transform var(--fast) var(--ease), background var(--fast) var(--ease);
}
.card:hover{ box-shadow:var(--shadow-2) }
.block-sub{font-size:.75rem;letter-spacing:.08em;text-transform:uppercase;color:var(--muted)}
.block-title{font-size:1.125rem;line-height:1.75rem;font-weight:800}

.btn-xs,.btn-xxs{
  border:var(--borderW) solid var(--border); background:#fff;
  transition:transform var(--fast) var(--ease), box-shadow var(--fast) var(--ease), background var(--fast) var(--ease);
}
.btn-xs:focus-visible,.btn-xxs:focus-visible{outline:2px solid var(--accent-100); box-shadow:0 0 0 2px rgba(14,165,233,.25)}
.btn-xs:hover,.btn-xxs:hover{transform:translateY(-1px)}
.btn-xs{font-size:.72rem;padding:.25rem .5rem;border-radius:.5rem}
.btn-xxs{font-size:.68rem;padding:.18rem .45rem;border-radius:.4rem}

.chip{
  padding:.35rem .65rem;border-radius:9999px;border:var(--borderW) solid var(--border);
  display:inline-flex;gap:.35rem;align-items:center;background:#fff;
  transition:transform var(--fast) var(--ease), box-shadow var(--fast) var(--ease), background var(--fast) var(--ease);
}
.chip:hover{background:var(--panel-muted); transform:translateY(-1px)}
.chip-active{border-color:var(--accent);box-shadow:0 0 0 2px rgba(14,165,233,.2);background:var(--accent-100);color:#0b4661}

.link-card{
  display:flex;align-items:center;gap:.6rem;padding:.55rem .75rem;border-radius:.75rem;border:var(--borderW) solid var(--border);background:var(--panel);
  transition:background var(--fast) var(--ease), transform var(--fast) var(--ease);
}
.link-card:hover{background:var(--panel-muted)}
.link-icon{width:18px;height:18px;display:inline-block}

.input{
  background:#fff;border:var(--borderW) solid var(--border);border-radius:.75rem;padding:.55rem .7rem;
  transition: box-shadow var(--fast) var(--ease);
}
.input:focus{outline:2px solid var(--accent-100);box-shadow:0 0 0 2px rgba(14,165,233,.25)}

.tabs-bar{display:flex;gap:0;border-radius:14px;padding:.35rem}
.tab-link{padding:.6rem 1rem;font-weight:800;color:var(--muted);border-radius:.6rem;white-space:nowrap;transition:background var(--fast) var(--ease), color var(--fast) var(--ease)}
.tab-link:hover{color:#111827;background:var(--panel-muted)}
.tab-link.active{color:#0b4661;background:var(--accent-100);box-shadow:inset 0 0 0 1px rgba(14,165,233,.5)}
.tab-sep{width:1px;height:22px;background:linear-gradient(180deg,transparent,#cbd5e1,transparent);margin:0 .25rem}

/* ===== Split + handle ===== */
#split{display:flex;gap:14px;align-items:stretch;--leftRatio:56%;position:relative;overflow:visible}
#leftPane{flex:0 0 var(--leftRatio);min-width:360px}
#rightPane{flex:1 1 auto;min-width:360px;max-width:900px}
#splitHandle{width:16px;position:relative;z-index:60;cursor:col-resize;align-self:stretch;user-select:none;background:transparent}
#splitHandle::before{content:"";position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:12px;height:72px;border-radius:999px;background:linear-gradient(180deg, #ffffff, #f1f5f9);border:1px solid color-mix(in srgb, var(--border) 70%, transparent);box-shadow:0 2px 8px rgba(15,23,42,.12), inset 0 0 0 1px rgba(255,255,255,.6)}
#splitHandle::after{content:"";position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:2px;height:2px;border-radius:1px;background:color-mix(in srgb, var(--muted) 80%, transparent);box-shadow:0 -10px 0 color-mix(in srgb, var(--muted) 80%, transparent),0  10px 0 color-mix(in srgb, var(--muted) 80%, transparent);opacity:.9}
#splitHandle:hover::before{ box-shadow:0 4px 14px rgba(15,23,42,.18), inset 0 0 0 1px rgba(255,255,255,.6) }
@media (max-width:980px){#split{display:block}#splitHandle{display:none}#leftPane,#rightPane{width:100%}}

/* ===== Planner rows ===== */
.outline-row{padding:.6rem .5rem;border-bottom:var(--borderW) solid var(--border);background:#fff;transition:background var(--fast) var(--ease)}
.outline-row:hover{background:var(--panel-muted)}
.outline-active{background:var(--accent-100)!important;box-shadow:inset 0 0 0 1px rgba(14,165,233,.5)}
.clock-badge{font-family:ui-monospace,Menlo,Consolas,monospace;font-weight:800;background:var(--accent-100);color:var(--accent-600);padding:.35rem .6rem;border-radius:.75rem;border:var(--borderW) solid color-mix(in srgb,var(--accent) 35%,var(--border))}

/* Remove ghost copy while dragging (keep element in flow) */
.drag-ghost{opacity:.35}
.outline-row.dragging,.section-preview.dragging{opacity:.35}

/* ===== Horizontal widget shelves ===== */
.editor-shelf{display:flex;flex-wrap:nowrap;gap:.5rem;overflow-x:auto;overflow-y:hidden;padding:.5rem;border:var(--borderW) solid var(--border);border-radius:.75rem;background:#fff;scroll-snap-type:x proximity;width:100%;min-width:0;scrollbar-gutter:stable both-edges;overscroll-behavior-x:contain}
.editor-shelf>*{scroll-snap-align:start}
.editor-shelf::-webkit-scrollbar{height:8px}
.editor-shelf::-webkit-scrollbar-thumb{background:color-mix(in srgb,var(--muted) 45%, transparent); border-radius:999px}
.editor-shelf::-webkit-scrollbar-track{background:transparent}
.section-links-bar{min-height:44px;border:var(--borderW) solid var(--border);border-radius:.75rem;background:#fff;padding:.5rem;display:flex;flex-wrap:wrap;gap:.5rem}
.section-links-bar.drag-over-outline{outline:2px dashed rgba(14,165,233,.9);outline-offset:4px}

/* ===== Saved-tab compact edit ===== */
.section-preview{padding:.35rem .6rem;margin-left:18px;background:var(--panel-muted);border:var(--borderW) solid var(--border);border-radius:.5rem;cursor:pointer;user-select:none;max-width:100%;min-width:0;transition:transform .12s ease}
.section-preview .title{font-weight:600;font-size:.98rem}
.section-preview .mins{min-width:2.5rem;text-align:right}
.section-preview .bin{margin-left:.25rem}

.section-edit{
  margin-left:0;background:var(--panel);border:var(--borderW) solid var(--border);border-radius:.6rem;
  padding:.75rem .8rem;width:100%;max-width:100%;min-width:0;overflow:hidden;
  display:flex;flex-direction:column;gap:.6rem;
}
.section-edit.compact-edit .row{display:grid;gap:.5rem;max-width:100%;min-width:0}
.section-edit .row + .row{margin-top:.6rem}
.section-edit .row.head{display:flex;align-items:center;gap:.5rem;max-width:100%;min-width:0;margin-bottom:.1rem}
.section-edit .row.head .lbl{font-size:.75rem;color:var(--muted);font-weight:600;white-space:nowrap}
.section-edit .title-input{height:32px;font-size:.95rem;padding:.35rem .5rem}
.section-edit .mins-wrap{margin-left:auto;display:flex;align-items:center;gap:.35rem}
.section-edit .mins-wrap .mins-input{width:72px;height:32px}
.section-edit textarea.input{min-height:96px;padding:.5rem .6rem}
.section-edit [data-role="inline-shelf"]{padding:.35rem .5rem;border-radius:.6rem;border:var(--borderW) solid var(--border);background:#fff;max-width:100%;min-width:0;margin-top:.2rem}
.link-card.section-link{padding:.28rem .45rem;min-height:30px;font-size:.9rem}
.add-pill{display:inline-flex;align-items:center;gap:.35rem;padding:.25rem .5rem;border-radius:.5rem;border:1px dashed var(--border);background:#fff;font-size:.9rem;cursor:pointer;user-select:none}
.add-pill::before{content:'+';font-weight:700}
.add-pill:hover{background:var(--panel)}

.widget{position:relative;display:inline-flex;align-items:center;gap:.35rem}
.widget .bin{position:absolute;top:-7px;right:-7px;border-radius:9999px;border:var(--borderW) solid var(--border);background:#fff;width:22px;height:22px;display:flex;align-items:center;justify-content:center;font-size:12px}

/* ===== Masonry list (avoid equal column heights) ===== */
#savedList{display:block !important;column-count:1;column-gap:1rem}
@media (min-width:1024px){#savedList{column-count:2}}
#savedList > .card{display:inline-block;width:100%;margin:0 0 1rem;break-inside:avoid}
#savedList .card{max-width:100%}
.section-edit,.section-preview,.section-edit .row,.section-links-bar,.editor-shelf,[data-role="inline-shelf"]{max-width:100%;min-width:0}
.draggable-shelf{min-width:0}

/* While dragging an outline title, prevent header buttons from stealing pointer events */
.is-merge-drag [data-oid] [data-role="outline-head"] [data-act]{pointer-events:none !important}

/* ===== Folder grid ===== */
.folder-grid{display:flex;flex-wrap:wrap;gap:12px}
.folder-card{width:140px;height:110px;border:var(--borderW) solid var(--border);border-radius:12px;background:var(--panel);display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;position:relative;box-shadow:0 2px 8px rgba(15,23,42,.04);transition:background var(--fast) var(--ease), transform var(--fast) var(--ease)}
.folder-card:hover{background:var(--panel-muted); transform:translateY(-1px)}
.folder-card .folder-icon{width:72px;height:48px;border-radius:8px;background:linear-gradient(180deg,#fde68a,#f59e0b);border:1px solid #d97706;position:relative;box-shadow:inset 0 -8px 0 rgba(0,0,0,.05)}
.folder-card .folder-icon::before{content:"";position:absolute;top:-10px;left:8px;width:32px;height:14px;border-radius:6px 6px 0 0;background:linear-gradient(180deg,#fff3b0,#facc15);border:1px solid #d97706;border-bottom:none}
.folder-card .folder-name{margin-top:8px;font-weight:700;max-width:100%;text-align:center}
.folder-drop{outline:2px dashed var(--accent);outline-offset:4px}
.folder-card .folder-del{position:absolute;top:-7px;right:-7px;border-radius:9999px;border:var(--borderW) solid var(--border);background:#fff;width:22px;height:22px;display:flex;align-items:center;justify-content:center;font-size:12px}

/* Breadcrumbs */
.breadcrumbs{display:flex;align-items:center;gap:.5rem;font-size:.9rem}
.crumb{padding:.15rem .5rem;border-radius:.5rem;border:var(--borderW) solid var(--border);background:#fff;cursor:pointer;user-select:none}
.crumb.active{background:var(--accent-100);border-color:var(--accent)}
.crumb-sep{opacity:.6}
.crumb-drop{outline:2px dashed var(--accent)}

/* Separator line */
.sep-line{border:0; border-top:var(--borderW) solid var(--border); opacity:.6; margin:10px 0}

/* ===== Modals (inâ€‘page) ===== */
.modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:80}
.modal.hidden{display:none}
.modal-backdrop{position:absolute;inset:0;background:rgba(0,0,0,.42);backdrop-filter:blur(2px)}
.modal-panel{position:relative;z-index:1;background:var(--panel);border:var(--borderW) solid var(--border);border-radius:14px;box-shadow:0 25px 70px rgba(15,23,42,.25);padding:18px;max-width:720px;width:calc(100% - 28px)}

/* Auth extras */
.auth-sep{display:flex;align-items:center;gap:.75rem;color:var(--muted);font-size:.9rem}
.auth-sep span{white-space:nowrap}
.auth-sep::before,.auth-sep::after{content:"";height:1px;background:color-mix(in srgb,var(--border) 70%,transparent);flex:1}
.btn-wide{min-width:160px;text-align:center}

/* ===== Toasts ===== */
.toast-host{position:fixed;right:14px;bottom:14px;display:flex;flex-direction:column;gap:8px;z-index:90}
.toast{background:#111827;color:#fff;padding:.55rem .75rem;border-radius:.65rem;transform:translateY(10px);opacity:0;transition:all .2s}
.toast.in{transform:translateY(0);opacity:1}
.toast.success{background:#059669}
.toast.error{background:#dc2626}

/* ===== TOUR overlay ===== */
.tour{position:fixed;inset:0;z-index:95}
.tour.hidden{display:none}
.tour-backdrop{position:absolute;inset:0;background:rgba(2,6,23,.55);backdrop-filter:blur(2px)}
.tour-panel{
  position:absolute;
  left:50%; top:20px; transform:translateX(-50%);
  max-width:420px; width:calc(100% - 28px);
  min-height:220px;
  background:var(--panel);
  border:var(--borderW) solid var(--border);
  border-radius:14px;
  padding:16px;
  box-shadow:0 30px 80px rgba(15,23,42,.35);
}
.tour-title{font-weight:800;margin-bottom:.25rem}
.tour-body{color:var(--muted);font-size:.95rem}
.tour-actions{display:flex;align-items:center;gap:.5rem;margin-top:.75rem}
.tour-actions .spacer{flex:1}
/* arrow */
.tour-panel::after{
  content:""; position:absolute; width:0; height:0; border:10px solid transparent;
}
.tour-panel--top::after{ /* panel BELOW anchor: arrow on top pointing up */
  top:-20px; left:24px; border-bottom-color:var(--panel);
}
.tour-panel--bottom::after{ /* panel ABOVE anchor: arrow on bottom pointing down */
  bottom:-20px; left:24px; border-top-color:var(--panel);
}
.tour-panel--left::after{ /* panel RIGHT of anchor: arrow on left */
  left:-20px; top:24px; border-right-color:var(--panel);
}
.tour-panel--right::after{ /* panel LEFT of anchor: arrow on right */
  right:-20px; top:24px; border-left-color:var(--panel);
}
/* Spotlighted anchor sits above the backdrop so it's not blurred/dimmed */
.spotlight{
  outline:3px solid var(--accent); outline-offset:2px; border-radius:12px;
  position:relative; z-index:96;
}

/* ===== Landing page ===== */
.landing-hero{display:grid;grid-template-columns:1.1fr .9fr;gap:16px;padding:18px}
.hero-copy{display:flex;flex-direction:column;gap:12px}
.hero-title{font-size:clamp(28px,3.4vw,42px);font-weight:900;line-height:1.1}
.hero-title em{color:var(--accent-600);font-style:normal}
.hero-sub{color:var(--muted)}
.hero-cta{display:flex;gap:8px;flex-wrap:wrap}
.hero-demo{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:10px;padding:6px}
.demo-progress{position:relative;width:100%;height:16px;border-radius:999px;background:var(--panel-muted);border:var(--borderW) solid var(--border);overflow:hidden}
.demo-progress.small{height:10px}
.demo-progress .demo-fill{position:absolute;left:0;top:0;bottom:0;width:0;background:linear-gradient(90deg,var(--accent-100),var(--accent));animation:fill 4s infinite}
.demo-progress .demo-seg{position:absolute;top:0;bottom:0;width:2px;background:rgba(0,0,0,.2)}
.demo-progress .demo-seg:nth-child(2){left:33%} .demo-progress .demo-seg:nth-child(3){left:66%}
.demo-captions{display:grid;grid-template-columns:1fr;gap:6px;font-size:.9rem;color:var(--muted)}
@keyframes fill{0%{width:0}50%{width:83%}100%{width:0}}
.landing-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-top:16px}
@media (max-width:1000px){.landing-hero{grid-template-columns:1fr}.landing-grid{grid-template-columns:1fr}}
.demo-box{display:flex;align-items:center;justify-content:center;min-height:120px;background:var(--panel);border:var(--borderW) solid var(--border);border-radius:12px;padding:12px}

/* extra breathing room for Overview cards */
.feature.card{padding:16px}

/* Utils */
.no-select{ user-select:none }
