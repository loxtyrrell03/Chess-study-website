:root{
  --bg:#ffffff; --fg:#0f172a; --muted:#475569;
  --border:#94a3b8; --borderW:2px;
  --panel:#ffffff; --panel-muted:#f8fafc;
  --accent:#0ea5e9; --accent-600:#0284c7; --accent-100:#e0f2fe;
}
*{box-sizing:border-box}

html,body{background:var(--bg);color:var(--fg)}
.muted{color:var(--muted)}
.card{background:var(--panel);border:var(--borderW) solid var(--border);border-radius:14px;box-shadow:0 3px 10px rgba(15,23,42,.04);overflow:hidden}
.block-sub{font-size:.75rem;letter-spacing:.08em;text-transform:uppercase;color:var(--muted)}
.block-title{font-size:1.125rem;line-height:1.75rem;font-weight:800}
.btn-xs{font-size:.72rem;padding:.25rem .5rem;border-radius:.5rem;border:var(--borderW) solid var(--border);background:#fff}
.btn-xxs{font-size:.68rem;padding:.18rem .45rem;border-radius:.4rem;border:var(--borderW) solid var(--border);background:#fff}
.chip{padding:.35rem .65rem;border-radius:9999px;border:var(--borderW) solid var(--border);display:inline-flex;gap:.35rem;align-items:center;background:#fff}
.chip:hover{background:var(--panel-muted)}
.chip-active{border-color:var(--accent);box-shadow:0 0 0 2px rgba(14,165,233,.2);background:var(--accent-100);color:#0b4661}
.link-card{display:flex;align-items:center;gap:.6rem;padding:.55rem .75rem;border-radius:.75rem;border:var(--borderW) solid var(--border);background:var(--panel)}
.link-card:hover{background:var(--panel-muted)}
.link-icon{width:18px;height:18px;display:inline-block}
.input{background:#fff;border:var(--borderW) solid var(--border);border-radius:.75rem;padding:.55rem .7rem}
.input:focus{outline:2px solid var(--accent-100);box-shadow:0 0 0 2px rgba(14,165,233,.25)}
.tabs-bar{display:flex;gap:0;border-bottom:var(--borderW) solid var(--border);background:var(--panel);border-radius:14px;padding:.35rem}
.tab-link{padding:.6rem 1rem;font-weight:800;color:var(--muted);border-radius:.6rem}
.tab-link:hover{color:#111827;background:var(--panel-muted)}
.tab-link.active{color:#0b4661;background:var(--accent-100);box-shadow:inset 0 0 0 1px rgba(14,165,233,.5)}
.tab-sep{width:1px;height:22px;background:linear-gradient(180deg,transparent,#cbd5e1,transparent);margin:0 .25rem}

/* Split layout + handle */
#split{
  display:flex;
  gap:14px;
  align-items:stretch;
  --leftRatio:56%;
  position:relative;
  overflow:visible;
}
#leftPane{flex:0 0 var(--leftRatio);min-width:360px}
#rightPane{flex:1 1 auto;min-width:360px;max-width:900px}

/* Modern visible grab handle */
#splitHandle{
  width:16px;
  position:relative;
  z-index:60;
  cursor:col-resize;
  align-self:stretch;
  user-select:none;
  background:transparent;
}
#splitHandle::before{
  content:"";
  position:absolute;
  left:50%; top:50%; transform:translate(-50%,-50%);
  width:12px; height:72px; border-radius:999px;
  background:linear-gradient(180deg, #ffffff, #f1f5f9);
  border:1px solid color-mix(in srgb, var(--border) 70%, transparent);
  box-shadow:0 2px 8px rgba(15,23,42,.12), inset 0 0 0 1px rgba(255,255,255,.6);
}
#splitHandle::after{
  content:"";
  position:absolute;
  left:50%; top:50%; transform:translate(-50%,-50%);
  width:2px; height:2px; border-radius:1px;
  background:color-mix(in srgb, var(--muted) 80%, transparent);
  box-shadow:0 -10px 0 color-mix(in srgb, var(--muted) 80%, transparent),
             0  10px 0 color-mix(in srgb, var(--muted) 80%, transparent);
  opacity:.9;
}
#splitHandle:hover::before{ box-shadow:0 4px 14px rgba(15,23,42,.18), inset 0 0 0 1px rgba(255,255,255,.6); }
@media (max-width:980px){#split{display:block}#splitHandle{display:none}#leftPane,#rightPane{width:100%}}

/* Outline rows */
.outline-row{padding:.6rem .5rem;border-bottom:var(--borderW) solid var(--border);background:#fff}
.outline-row:hover{background:var(--panel-muted)}
.outline-active{background:var(--accent-100)!important;box-shadow:inset 0 0 0 1px rgba(14,165,233,.5)}
.clock-badge{font-family:ui-monospace,Menlo,Consolas,monospace;font-weight:800;background:var(--accent-100);color:var(--accent-600);padding:.35rem .6rem;border-radius:.75rem;border:var(--borderW) solid color-mix(in srgb,var(--accent) 35%,var(--border))}
.drag-ghost{opacity:.4}
.drag-over-outline{outline:2px dashed rgba(14,165,233,.9);outline-offset:4px}
.section-collapsed{margin-left:16px;background:var(--panel-muted);border:var(--borderW) dashed var(--border);border-radius:10px;padding:.45rem .6rem;font-size:.92rem;display:flex;align-items:center;justify-content:space-between}

/* ======= Horizontal widget shelves (scrollbar/slider) ======= */
.editor-shelf{
  display:flex; flex-wrap:nowrap; gap:.5rem; overflow-x:auto; overflow-y:hidden;
  padding:.5rem; border:var(--borderW) solid var(--border); border-radius:.75rem; background:#fff;
  scroll-snap-type:x proximity; width:100%; min-width:0; scrollbar-gutter: stable both-edges; overscroll-behavior-x: contain;
}
.editor-shelf > *{ scroll-snap-align:start; }
.editor-shelf::-webkit-scrollbar{ height:8px; }
.editor-shelf::-webkit-scrollbar-thumb{ background:color-mix(in srgb,var(--muted) 45%, transparent); border-radius:999px; }
.editor-shelf::-webkit-scrollbar-track{ background:transparent; }

.editor-link-row{display:flex;align-items:center;gap:.5rem}
.no-print{print-color-adjust:exact}

/* ======= Modals ======= */
.modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:80}
.modal.hidden{display:none}
.modal-backdrop{position:absolute;inset:0;background:rgba(0,0,0,.42);backdrop-filter:blur(2px)}
.modal-panel{position:relative;z-index:1;background:var(--panel);border:var(--borderW) solid var(--border);border-radius:14px;box-shadow:0 25px 70px rgba(15,23,42,.25);padding:18px;max-width:720px;width:calc(100% - 28px)}

/* Auth extras */
.auth-sep{display:flex;align-items:center;gap:.75rem;color:var(--muted);font-size:.9rem}
.auth-sep span{white-space:nowrap}
.auth-sep::before,.auth-sep::after{content:"";height:1px;background:color-mix(in srgb,var(--border) 70%,transparent);flex:1}
.btn-wide{min-width:160px;text-align:center}

/* ======= Saved-tab widget extras ======= */
.widget{position:relative}
.widget .bin{position:absolute;top:-8px;right:-8px;border-radius:9999px;border:var(--borderW) solid var(--border);background:#fff;padding:.2rem .35rem;line-height:1}
.widget .bin:hover{background:#fee2e2;border-color:#fecaca}
.section-links-bar{min-height:36px;border:var(--borderW) solid var(--border);border-radius:.75rem;background:#fff;padding:.35rem .45rem;display:flex;flex-wrap:wrap;gap:.4rem}
.section-links-bar.drag-over-outline{outline:2px dashed rgba(14,165,233,.9);outline-offset:2px}

/* ==== Saved Outlines (compact edit layout) ==== */
.section-preview {
  padding: .35rem .6rem;
  margin-left: 18px;
  background: var(--panel-muted);
  border: var(--borderW) solid var(--border);
  border-radius: .5rem;
  cursor: pointer;
  user-select: none;
  max-width:100%;
  min-width:0;
  transition: transform .12s ease;
}
.section-preview .title { font-weight: 600; font-size: .98rem; }
.section-preview .mins { min-width: 2.5rem; text-align: right; }
.section-preview .bin { margin-left: .25rem; }

/* Edit card container (compact) */
.section-edit {
  margin-left: 0;
  background: var(--panel);
  border: var(--borderW) solid var(--border);
  border-radius: .6rem;
  padding: .5rem .6rem;
  width:100%;
  max-width:100%;
  min-width:0;
  overflow:hidden;
}
.section-edit.compact-edit .row { display: grid; gap: .35rem; max-width:100%; min-width:0; }

/* Header row */
.section-edit .row.head {
  display: flex; align-items: center; gap: .5rem; max-width:100%; min-width:0;
}
.section-edit .row.head .lbl { font-size: .75rem; color: var(--muted); font-weight: 600; white-space: nowrap; }
.section-edit .title-input { height: 30px; font-size: .95rem; padding: .35rem .5rem; }
.section-edit .mins-wrap { margin-left: auto; display: flex; align-items: center; gap: .35rem; }
.section-edit .mins-wrap .mins-input { width: 72px; height: 30px; }

/* Description */
.section-edit textarea.input { min-height: 70px; padding: .5rem .6rem; }

/* Inline shelf */
.section-edit [data-role="inline-shelf"] {
  padding: .35rem .5rem; border-radius: .6rem; border: var(--borderW) solid var(--border); background: #fff;
  max-width:100%; min-width:0;
}

/* Links bar (compact) */
.link-card.section-link { padding: .28rem .45rem; min-height: 28px; font-size: .9rem; }

/* Add pill inside Links bar */
.add-pill {
  display: inline-flex; align-items: center; gap: .35rem; padding: .25rem .5rem;
  border-radius: .5rem; border: 1px dashed var(--border); background: #fff; font-size: .9rem; cursor: pointer; user-select: none;
}
.add-pill::before { content: '+'; font-weight: 700; }
.add-pill:hover { background: var(--panel); }

/* Drag feedback */
.drag-ghost { opacity: .6; }
.drag-over-outline { outline: 2px dashed var(--accent); outline-offset: 2px; }

/* ===== Spacing fixes between edit areas ===== */
.section-edit .row + [data-role="inline-shelf"],
.section-edit [data-role="inline-shelf"] + .row,
.section-edit .row + .row { margin-top: .6rem; }

/* Utilities */
.input { line-height: 1.2; }
.btn-xxs, .btn-xs { line-height: 1; }

/* ===== Prevent saved-list cards from sharing heights (masonry columns) ===== */
#savedList{
  display:block !important;
  column-count:1;
  column-gap:1rem;
  min-height:80px;
}
@media (min-width:1024px){
  #savedList{ column-count:2; }
}
#savedList > .card{
  display:inline-block;
  width:100%;
  margin:0 0 1rem;
  break-inside:avoid;
}
#savedList.root-drop{ outline:2px dashed var(--accent); outline-offset:6px; }

/* Keep elements inside cards */
#savedList .card{ max-width:100%; }
.section-edit, .section-preview, .section-edit .row, .section-links-bar, .editor-shelf, [data-role="inline-shelf"]{
  max-width:100%;
  min-width:0;
}
.draggable-shelf{ min-width:0; }

/* ===== Outline merge improvements ===== */
.is-merge-drag [data-oid] [data-role="outline-head"] [data-act]{ pointer-events: none !important; }

/* ===== Reorder placeholder ===== */
.drop-placeholder{
  opacity:.6;
  border:2px dashed var(--accent);
  background: color-mix(in srgb, var(--accent-100) 60%, transparent);
  height: var(--ph, 44px);
}
.section-preview.dragging{ display:none; }

/* ===== Landing demo ===== */
.landing-hero .demo .demo-progress{
  position:relative; height:16px; border-radius:999px;
  border:var(--borderW) solid var(--border); background:var(--panel-muted); overflow:hidden;
}
.landing-hero .demo .demo-progress #demoFill{
  position:absolute; left:0; top:0; bottom:0; width:0%;
  background:linear-gradient(90deg,var(--accent-100),color-mix(in srgb,var(--accent) 55%, transparent));
  border-right:2px solid var(--accent-600);
  transition:width .06s linear;
}
.landing-hero .demo .demo-progress .demo-seg{
  position:relative; display:inline-block; height:100%; width:var(--w);
  box-shadow:inset -2px 0 0 rgba(0,0,0,.35);
}

/* ===== Folder visual ===== */
.folder-card{
  position:relative;
  border-radius:12px;
  background:var(--panel);
  border:var(--borderW) solid var(--border);
  padding-top:10px;
}
.folder-card::before{
  /* folder tab */
  content:"";
  position:absolute; left:14px; top:-10px;
  width:92px; height:18px;
  border-radius:8px 8px 0 0;
  background:color-mix(in srgb, var(--accent-100) 70%, #fff);
  border:var(--borderW) solid var(--border);
  border-bottom:0;
  box-shadow:0 2px 6px rgba(15,23,42,.06);
}
.folder-head{
  display:flex; align-items:center; gap:.5rem; padding: .2rem .25rem .4rem .25rem;
}
.folder-body{ padding:.4rem; border-radius:10px; background:var(--panel-muted); border:var(--borderW) dashed var(--border); }
.folder-actions .btn-xxs{ background:#fff; }

/* ===== Focus tweaks ===== */
#focusOverlay .card{ background:var(--panel); }
